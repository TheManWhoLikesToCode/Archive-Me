FROM python:3.9-bullseye

WORKDIR /backend

ADD . /backend

ARG GOOGLE_CLIENT_SECRET
ENV GOOGLE_CLIENT_SECRET=$GOOGLE_CLIENT_SECRET

ARG GOOGLE_CLIENT_ID
ENV GOOGLE_CLIENT_ID=$GOOGLE_CLIENT_ID

ARG CLIENT_CREDENTIALS_JSON
ENV CLIENT_CREDENTIALS_JSON=$CLIENT_CREDENTIALS_JSON
RUN echo "$CLIENT_CREDENTIALS_JSON" > /backend/credentials.json

ARG ENVIRONMENT
ENV ENVIRONMENT=$ENVIRONMENT

ARG PORT
ENV PORT=$PORT

EXPOSE $PORT

RUN pip install -r requirements.txt

CMD python ./app.py